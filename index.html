<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CoAST Interactive – Antimicrobial Activity</title>
<style>
  :root {
    /* Light mode default */
    --bg: #f6f7fb;
    --panel: #ffffff;
    --panel2: #f3f4f6;
    --text: #111827;
    --muted: #4b5563;
    --border: #e5e7eb;
    --accent: #0284c7;
    --theadBg: rgba(255,255,255,0.92);

    --btn-bg: #ffffff;
    --btn-fg: #111827;
    --btn-bg-hover: #f3f4f6;

    --good3: rgba(16, 185, 129, 0.18);
    --good2: rgba(59, 130, 246, 0.14);
    --good1: rgba(234, 179, 8, 0.16);
    --bad: rgba(239, 68, 68, 0.16);
    --none: rgba(148, 163, 184, 0.12);
  }

  html[data-theme="dark"] {
    --bg: #0b0c10;
    --panel: #111319;
    --panel2: #0f1116;
    --text: #e8e8ea;
    --muted: #b6b7bc;
    --border: #252836;
    --accent: #7dd3fc;
    --theadBg: rgba(17,19,25,0.96);

    --btn-bg: #1f2430;
    --btn-fg: #e8e8ea;
    --btn-bg-hover: #2a3140;

    --good3: rgba(16, 185, 129, 0.20);
    --good2: rgba(59, 130, 246, 0.18);
    --good1: rgba(234, 179, 8, 0.18);
    --bad: rgba(239, 68, 68, 0.18);
    --none: rgba(148, 163, 184, 0.10);
  }
body {
    margin: 0;
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    background: var(--bg);
    color: var(--text);
  }
  header {
    padding: 18px 18px 10px 18px;
    border-bottom: 1px solid var(--border);
    background: linear-gradient(180deg, rgba(125,211,252,0.08), rgba(0,0,0,0));
  }
  header h1 {
    margin: 0;
    font-size: 18px;
    font-weight: 700;
    letter-spacing: 0.2px;
  }
  header .sub {
    margin-top: 6px;
    color: var(--muted);
    font-size: 13px;
    line-height: 1.35;
  }
  .wrap {
    display: flex;
    flex-direction: column;
    gap: 12px;
    padding: 12px;
  }
.panel {
    background: var(--panel);
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 14px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.25);
  }
  .panel h2 {
    margin: 0 0 10px 0;
    font-size: 14px;
    color: var(--muted);
    letter-spacing: 0.2px;
    text-transform: uppercase;
  }
  .row { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 10px; }
  label { display: block; font-size: 12.5px; color: var(--muted); margin-bottom: 6px; }
  input[type="text"], select {
    width: 100%;
    box-sizing: border-box;
    padding: 10px 10px;
    border-radius: 10px;
    border: 1px solid var(--border);
    background: var(--panel2);
    color: var(--text);
    outline: none;
  }
  select[multiple] { min-height: 120px; }
  .tiny { font-size: 12px; color: var(--muted); }
  .controls { display: flex; gap: 8px; flex-wrap: wrap; margin-top: 6px; }
  button {
    padding: 9px 10px;
    border-radius: 10px;
    border: 1px solid var(--border);
    background: var(--btn-bg);
    color: var(--btn-fg);
    cursor: pointer;
    font-weight: 600;
    font-size: 13px;
  }
  button:hover { border-color: rgba(125,211,252,0.6); }
  .pill {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 6px 10px;
    border-radius: 999px;
    border: 1px solid var(--border);
    background: rgba(125,211,252,0.06);
    color: var(--text);
    font-size: 12.5px;
    margin: 6px 6px 0 0;
  }
  .legend { display: grid; grid-template-columns: repeat(3, minmax(0, 1fr)); gap: 8px; margin-top: 10px; }
  .swatch {
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 8px;
    font-size: 12px;
    color: var(--muted);
    background: rgba(255,255,255,0.02);
  }
  .swatch b { color: var(--text); }
  .tablewrap {
    position: relative;
    border-radius: 14px;
    border: 1px solid var(--border);
    background: var(--panel);
  overflow: auto;
  scrollbar-gutter: stable both-edges;
  }

/* Top horizontal scrollbar (synced with main table) */
.hscroll-top{
  overflow-x: auto;
  overflow-y: hidden;
  height: 14px;
  margin: 0 0 6px 0;
  display: none; /* shown only when table overflows */
}
.hscroll-inner{ height: 1px; }
table { border-collapse: separate; border-spacing: 0; width: 100%; min-width: 900px; }
  thead th {
    position: sticky;
    top: 0;
    z-index: 2;
    background: var(--theadBg);
    backdrop-filter: blur(6px);
    border-bottom: 1px solid var(--border);
    font-size: 12px;
    text-align: left;
    padding: 10px 10px;
    white-space: nowrap;
    cursor: pointer;
  }
  tbody td {
    border-bottom: 1px solid rgba(37,40,54,0.8);
    padding: 9px 10px;
    font-size: 12.5px;
    vertical-align: top;
  }
  tbody tr:hover td { background: rgba(125,211,252,0.05); }
  .meta { white-space: nowrap; }
  .activity {
    font-weight: 700;
    text-align: center;
    border-left: 1px solid rgba(37,40,54,0.5);
    border-right: 1px solid rgba(37,40,54,0.5);
  }
  .a3 { background: var(--good3); }
  .a2 { background: var(--good2); }
  .a1 { background: var(--good1); }
  .a0 { background: var(--bad); }
  .aN { background: var(--none); color: rgba(232,232,234,0.65); }
  .topbar {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
    align-items: baseline;
    justify-content: space-between;
    margin-bottom: 10px;
  }
  .count { color: var(--muted); font-size: 12.5px; }
  .notice { color: var(--muted); font-size: 12.5px; line-height: 1.35; }
  .checkrow { display: grid; grid-template-columns: 18px 1fr; align-items: center; gap: 8px; margin: 8px 0 0 0; }
  .checkrow input { width: 16px; height: 16px; }
  .radio { display: grid; grid-template-columns: 18px 1fr; align-items: center; gap: 8px; margin: 6px 0 0 0; }
  .kbd {
    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    font-size: 12px;
    padding: 2px 6px;
    border: 1px solid var(--border);
    border-radius: 6px;
    background: rgba(255,255,255,0.03);
    color: var(--text);
  }
  .footer { padding: 0 12px 12px 12px; color: var(--muted); font-size: 12px; }
  a { color: var(--accent); text-decoration: none; }
  a:hover { text-decoration: underline; }

  .spanAll { grid-column: 1 / -1; }

  /* Sticky left columns (Drug/Route/etc.) */
  th.sticky-left {
    position: sticky;
    left: 0;
    z-index: 6;
    background: var(--theadBg);
  }
  td.sticky-left {
    position: sticky;
    left: 0;
    z-index: 3;
    background: var(--panel);
  }
  th.sticky-left, td.sticky-left {
    box-shadow: 1px 0 0 var(--border);
  }
  /* Sticky header row (keeps column labels visible while scrolling) */
  thead th{
    position: sticky;
    top: 0;
    z-index: 5;
    background: var(--theadBg);
  }
  thead th.sticky-left{ z-index: 7; }

  /* Column resize handle */
  .col-resizer {
    position: absolute;
    top: 0;
    right: -2px;
    width: 8px;
    height: 100%;
    cursor: col-resize;
    user-select: none;
    touch-action: none;
  }
  .col-resizer::after{
    content:"";
    position:absolute;
    top:0; bottom:0;
    left:3px;
    width:2px;
    background: rgba(0,0,0,0.12);
  }
  html[data-theme="dark"] .col-resizer::after{
    background: rgba(255,255,255,0.18);
  }

  td.sticky-left { border-right: 1px solid rgba(0,0,0,0); }


  header {
    padding: 18px 18px 10px 18px;
    border-bottom: 1px solid var(--border);
    background: linear-gradient(180deg, rgba(2,132,199,0.10), rgba(0,0,0,0));
  }
  .headRow{
    display:flex;
    align-items:flex-start;
    justify-content:space-between;
    gap:12px;
    flex-wrap:wrap;
  }
  .headActions{ display:flex; gap:8px; align-items:center; }

</style>
</head>
<body>
<header>
  <div class="headRow">
    <div>
      <h1>CoAST Interactive – Antimicrobial Activity by Organism</h1>
      <div class="sub">
        Offline, self-contained HTML. Filter by <span class="kbd">bug</span>, <span class="kbd">drug</span>, and <span class="kbd">route</span>.
        Click column headers to sort. Export filtered rows to CSV.
      </div>
    </div>
    <div class="headActions">
      <button id="themeBtn" type="button" title="Toggle light/dark">Dark mode</button>
    </div>
  </div>
</header>

<div class="wrap">
  <aside class="panel" id="filters">
    <h2>Filters</h2>

    <div class="row">
      <div>
        <label for="category">Category</label>
        <select id="category" multiple>
          <option value="Antibacterials" selected>Antibacterials</option>
<option value="Antifungals" selected>Antifungals</option>
<option value="Antivirals" selected>Antivirals</option>
        </select>
        <div class="tiny">Tip: hold <span class="kbd">⌘</span> (Mac) / <span class="kbd">Ctrl</span> (Win) to multi-select.</div>
      </div>

      <div>
        <label for="route">Route</label>
        <select id="route" multiple>
          <option value="INH" selected>INH</option>
<option value="INH/PO" selected>INH/PO</option>
<option value="IV" selected>IV</option>
<option value="IV/PO" selected>IV/PO</option>
<option value="PO" selected>PO</option>
        </select>
      </div>

      <div>
        <label for="drugSearch">Drug name contains</label>
        <input id="drugSearch" type="text" placeholder="e.g., cefepime, vanc, fluconazole"/>
      </div>

      <div>
        <label for="drugPick">Drugs (pick list)</label>
        <select id="drugPick" multiple>
          <option value="Acyclovir/Valacyclovir">Acyclovir/Valacyclovir</option>
<option value="Amoxicillin">Amoxicillin</option>
<option value="Amoxicillin/clavulanate">Amoxicillin/clavulanate</option>
<option value="Amphotericin B">Amphotericin B</option>
<option value="Ampicillin">Ampicillin</option>
<option value="Ampicillin/sulbactam">Ampicillin/sulbactam</option>
<option value="Azithromycin">Azithromycin</option>
<option value="Aztreonam">Aztreonam</option>
<option value="Baloxavir">Baloxavir</option>
<option value="Caspo/mica/ anidulafungin">Caspo/mica/ anidulafungin</option>
<option value="Cefazolin">Cefazolin</option>
<option value="Cefepime">Cefepime</option>
<option value="Cefotetan/Cefoxitin">Cefotetan/Cefoxitin</option>
<option value="Ceftaroline">Ceftaroline</option>
<option value="Ceftazidime">Ceftazidime</option>
<option value="Ceftazidime/avibactam">Ceftazidime/avibactam</option>
<option value="Ceftolozane/tazobactam">Ceftolozane/tazobactam</option>
<option value="Ceftriaxone/Cefotaxime">Ceftriaxone/Cefotaxime</option>
<option value="Cefuroxime">Cefuroxime</option>
<option value="Cephalexin">Cephalexin</option>
<option value="Cidofovir">Cidofovir</option>
<option value="Ciprofloxacin">Ciprofloxacin</option>
<option value="Clarithromycin">Clarithromycin</option>
<option value="Clindamycin">Clindamycin</option>
<option value="Daptomycin">Daptomycin</option>
<option value="Dicloxacillin">Dicloxacillin</option>
<option value="Doxycycline">Doxycycline</option>
<option value="Ertapenem">Ertapenem</option>
<option value="Erythromycin">Erythromycin</option>
<option value="Famciclovir">Famciclovir</option>
<option value="Fluconazole">Fluconazole</option>
<option value="Foscarnet">Foscarnet</option>
<option value="Ganciclovir/Valganciclovir">Ganciclovir/Valganciclovir</option>
<option value="Gentamicin/tobramycin">Gentamicin/tobramycin</option>
<option value="Imi/Meropenem">Imi/Meropenem</option>
<option value="Itraconazole">Itraconazole</option>
<option value="Letermovir">Letermovir</option>
<option value="Levofloxacin">Levofloxacin</option>
<option value="Linezolid">Linezolid</option>
<option value="Metronidazole">Metronidazole</option>
<option value="Molnupiravir">Molnupiravir</option>
<option value="Moxifloxacin">Moxifloxacin</option>
<option value="Nafcillin">Nafcillin</option>
<option value="Nirmatrelvir">Nirmatrelvir</option>
<option value="Oseltamivir">Oseltamivir</option>
<option value="Penicillin G">Penicillin G</option>
<option value="Piperacillin/tazobactam">Piperacillin/tazobactam</option>
<option value="Posa/Isavuconazole">Posa/Isavuconazole</option>
<option value="Remdesivir">Remdesivir</option>
<option value="Ribavirin">Ribavirin</option>
<option value="TMP/SMX">TMP/SMX</option>
<option value="Tigecycline">Tigecycline</option>
<option value="Vancomycin/Dalba/Orita">Vancomycin/Dalba/Orita</option>
<option value="Voriconazole">Voriconazole</option>
<option value="Zanamivir">Zanamivir</option>
        </select>
        <div class="tiny">If you select any drugs here, the table will show only those.</div>
      </div>

      <div class="spanAll">
        <label for="organisms">Organisms (“bugs”)</label>
        <select id="organisms" multiple></select>
        <div class="checkrow">
          <input type="checkbox" id="showOnlySelectedOrgs" checked/>
          <div class="tiny">Show only selected organism columns in the table</div>
        </div>
      </div>

      <div class="panel spanAll" style="padding:12px; background: rgba(255,255,255,0.04);">
        <div style="display:flex; gap:12px; flex-wrap:wrap;">
          <div style="min-width: 190px; flex: 1;">
            <label for="minActivity">Minimum activity required (for organism filter)</label>
            <select id="minActivity">
              <option value="1" selected>Any activity (+ / ++ / +++ / syn)</option>
              <option value="2">Moderate or better (++ / +++ / syn)</option>
              <option value="3">Strong only (+++)</option>
            </select>
          </div>

          <div style="min-width: 170px; flex: 1;">
            <label>Match across selected organisms</label>
            <div class="radio"><input type="radio" name="orgMatch" value="any" id="orgAny" checked/><div class="tiny"><b>ANY</b> selected organism passes</div></div>
            <div class="radio"><input type="radio" name="orgMatch" value="all" id="orgAll"/><div class="tiny"><b>ALL</b> selected organisms must pass</div></div>
          </div>
        </div>
        <div class="notice" style="margin-top:10px;">
          Filtering by organisms is blunt by design: it uses the symbols in the sheet (not MICs, not local epidemiology, not site-specific PK/PD).
        </div>
      </div>

      <div class="controls">
        <button id="resetBtn" type="button">Reset</button>
        <button id="exportBtn" type="button">Export filtered CSV</button>
      </div>

      <div>
        <h2 style="margin-top: 14px;">Legend</h2>
        <div class="legend">
          <div class="swatch"><b>+++</b> strong</div>
          <div class="swatch"><b>++</b> moderate</div>
          <div class="swatch"><b>+</b> weak / variable</div>
          <div class="swatch"><b>syn</b> synergy note</div>
          <div class="swatch"><b>--</b> poor</div>
          <div class="swatch"><b>X</b> no / not useful</div>
        </div>
      </div>

      <div class="notice" style="margin-top: 6px;">
        CoAST is for teaching; real-world choices depend on site of infection, patient factors, and local susceptibility patterns.
      </div>
    </div>
  </aside>

  <main class="panel">
    <div class="topbar">
      <div>
        <div id="activeFilters"></div>
        <div class="count" id="count"></div>
      </div>
      <div class="notice">
        Keyboard: <span class="kbd">/</span> focuses search • <span class="kbd">Esc</span> clears search
      </div>
    </div>

    <div id="topHScroll" class="hscroll-top" aria-hidden="true"><div id="topHScrollInner" class="hscroll-inner"></div></div>
<div class="tablewrap" id="resultsWrap">
  <table id="resultsTable" aria-label="Antimicrobial activity table">
    <colgroup id="resultsColgroup"></colgroup>
    <thead>
      <tr id="theadRow"></tr>
    </thead>
    <tbody id="tbody"></tbody>
  </table>
</div>
  </main>
</div>

<div class="footer">
  Generated 2026-02-09 from CoAST_2026.xlsx. If you update the spreadsheet, re-run the generator to refresh this HTML.
</div>

<script>
  const DATA = [{"Category": "Antibacterials", "Drug": "Penicillin G", "Class": "Penicillin", "Route": "IV", "Strep pyogenes": "+++", "S. pneumoniae": "++", "Staph aureus (MSSA)": "--", "Staph aureus (MRSA)": "X", "Enterooccus faecalis": "++", "Enterococcus faecium (VRE)": "--", "H. influenzae": "--", "Moraxella cattarhalis": "--", "Proteus spp.": "X", "E. coli": "X", "Klebsiella": "X", "Serratia": "X", "Enterobacter cloacae": "X", "Pseudomonas aeruginosa": "X", "Atypical respiratory pathogens": "X", "B. fragilis": "--", "Spectrum Score": "12.0", "Original Order": "", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "", "Varicella-zoster virus": "", "Cyto-megalovirus": "", "Respiratory syncytial virus": "", "Influenza A": "", "Influenza B": "", "SARS-CoV-2": ""}, {"Category": "Antibacterials", "Drug": "Amoxicillin", "Class": "Penicillin", "Route": "PO", "Strep pyogenes": "+++", "S. pneumoniae": "++", "Staph aureus (MSSA)": "--", "Staph aureus (MRSA)": "X", "Enterooccus faecalis": "+++", "Enterococcus faecium (VRE)": "--", "H. influenzae": "++", "Moraxella cattarhalis": "--", "Proteus spp.": "--", "E. coli": "--", "Klebsiella": "X", "Serratia": "--", "Enterobacter cloacae": "X", "Pseudomonas aeruginosa": "X", "Atypical respiratory pathogens": "X", "B. fragilis": "--", "Spectrum Score": "18.0", "Original Order": "", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "", "Varicella-zoster virus": "", "Cyto-megalovirus": "", "Respiratory syncytial virus": "", "Influenza A": "", "Influenza B": "", "SARS-CoV-2": ""}, {"Category": "Antibacterials", "Drug": "Ampicillin", "Class": "Penicillin", "Route": "IV", "Strep pyogenes": "+++", "S. pneumoniae": "++", "Staph aureus (MSSA)": "--", "Staph aureus (MRSA)": "X", "Enterooccus faecalis": "+++", "Enterococcus faecium (VRE)": "--", "H. influenzae": "++", "Moraxella cattarhalis": "--", "Proteus spp.": "--", "E. coli": "--", "Klebsiella": "X", "Serratia": "--", "Enterobacter cloacae": "X", "Pseudomonas aeruginosa": "X", "Atypical respiratory pathogens": "X", "B. fragilis": "--", "Spectrum Score": "18.0", "Original Order": "", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "", "Varicella-zoster virus": "", "Cyto-megalovirus": "", "Respiratory syncytial virus": "", "Influenza A": "", "Influenza B": "", "SARS-CoV-2": ""}, {"Category": "Antibacterials", "Drug": "Nafcillin", "Class": "Penicillin", "Route": "IV", "Strep pyogenes": "+++", "S. pneumoniae": "++", "Staph aureus (MSSA)": "+++", "Staph aureus (MRSA)": "X", "Enterooccus faecalis": "--", "Enterococcus faecium (VRE)": "--", "H. influenzae": "--", "Moraxella cattarhalis": "--", "Proteus spp.": "X", "E. coli": "X", "Klebsiella": "X", "Serratia": "X", "Enterobacter cloacae": "X", "Pseudomonas aeruginosa": "X", "Atypical respiratory pathogens": "X", "B. fragilis": "--", "Spectrum Score": "8.0", "Original Order": "", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "", "Varicella-zoster virus": "", "Cyto-megalovirus": "", "Respiratory syncytial virus": "", "Influenza A": "", "Influenza B": "", "SARS-CoV-2": ""}, {"Category": "Antibacterials", "Drug": "Dicloxacillin", "Class": "Penicillin", "Route": "PO", "Strep pyogenes": "+++", "S. pneumoniae": "++", "Staph aureus (MSSA)": "+++", "Staph aureus (MRSA)": "X", "Enterooccus faecalis": "--", "Enterococcus faecium (VRE)": "--", "H. influenzae": "--", "Moraxella cattarhalis": "--", "Proteus spp.": "X", "E. coli": "X", "Klebsiella": "X", "Serratia": "X", "Enterobacter cloacae": "X", "Pseudomonas aeruginosa": "X", "Atypical respiratory pathogens": "X", "B. fragilis": "--", "Spectrum Score": "9.0", "Original Order": "", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "", "Varicella-zoster virus": "", "Cyto-megalovirus": "", "Respiratory syncytial virus": "", "Influenza A": "", "Influenza B": "", "SARS-CoV-2": ""}, {"Category": "Antibacterials", "Drug": "Amoxicillin/clavulanate", "Class": "Penicillin", "Route": "PO", "Strep pyogenes": "+++", "S. pneumoniae": "++", "Staph aureus (MSSA)": "+++", "Staph aureus (MRSA)": "X", "Enterooccus faecalis": "+++", "Enterococcus faecium (VRE)": "--", "H. influenzae": "+++", "Moraxella cattarhalis": "+++", "Proteus spp.": "++", "E. coli": "++", "Klebsiella": "++", "Serratia": "--", "Enterobacter cloacae": "X", "Pseudomonas aeruginosa": "X", "Atypical respiratory pathogens": "X", "B. fragilis": "+++", "Spectrum Score": "29.0", "Original Order": "", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "", "Varicella-zoster virus": "", "Cyto-megalovirus": "", "Respiratory syncytial virus": "", "Influenza A": "", "Influenza B": "", "SARS-CoV-2": ""}, {"Category": "Antibacterials", "Drug": "Ampicillin/sulbactam", "Class": "Penicillin", "Route": "IV", "Strep pyogenes": "+++", "S. pneumoniae": "++", "Staph aureus (MSSA)": "+++", "Staph aureus (MRSA)": "X", "Enterooccus faecalis": "+++", "Enterococcus faecium (VRE)": "--", "H. influenzae": "+++", "Moraxella cattarhalis": "+++", "Proteus spp.": "++", "E. coli": "++", "Klebsiella": "++", "Serratia": "--", "Enterobacter cloacae": "X", "Pseudomonas aeruginosa": "X", "Atypical respiratory pathogens": "X", "B. fragilis": "+++", "Spectrum Score": "29.0", "Original Order": "", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "", "Varicella-zoster virus": "", "Cyto-megalovirus": "", "Respiratory syncytial virus": "", "Influenza A": "", "Influenza B": "", "SARS-CoV-2": ""}, {"Category": "Antibacterials", "Drug": "Piperacillin/tazobactam", "Class": "Penicillin", "Route": "IV", "Strep pyogenes": "+++", "S. pneumoniae": "++", "Staph aureus (MSSA)": "+++", "Staph aureus (MRSA)": "X", "Enterooccus faecalis": "++", "Enterococcus faecium (VRE)": "--", "H. influenzae": "+++", "Moraxella cattarhalis": "+++", "Proteus spp.": "+++", "E. coli": "+++", "Klebsiella": "+++", "Serratia": "+++", "Enterobacter cloacae": "++", "Pseudomonas aeruginosa": "++", "Atypical respiratory pathogens": "X", "B. fragilis": "+++", "Spectrum Score": "39.0", "Original Order": "", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "", "Varicella-zoster virus": "", "Cyto-megalovirus": "", "Respiratory syncytial virus": "", "Influenza A": "", "Influenza B": "", "SARS-CoV-2": ""}, {"Category": "Antibacterials", "Drug": "Cefazolin", "Class": "Cephalosporin", "Route": "IV", "Strep pyogenes": "+++", "S. pneumoniae": "++", "Staph aureus (MSSA)": "+++", "Staph aureus (MRSA)": "X", "Enterooccus faecalis": "X", "Enterococcus faecium (VRE)": "X", "H. influenzae": "--", "Moraxella cattarhalis": "--", "Proteus spp.": "+", "E. coli": "+", "Klebsiella": "+", "Serratia": "X", "Enterobacter cloacae": "X", "Pseudomonas aeruginosa": "X", "Atypical respiratory pathogens": "X", "B. fragilis": "--", "Spectrum Score": "16.0", "Original Order": "", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "", "Varicella-zoster virus": "", "Cyto-megalovirus": "", "Respiratory syncytial virus": "", "Influenza A": "", "Influenza B": "", "SARS-CoV-2": ""}, {"Category": "Antibacterials", "Drug": "Cephalexin", "Class": "Cephalosporin", "Route": "PO", "Strep pyogenes": "+++", "S. pneumoniae": "+++", "Staph aureus (MSSA)": "++", "Staph aureus (MRSA)": "X", "Enterooccus faecalis": "X", "Enterococcus faecium (VRE)": "X", "H. influenzae": "--", "Moraxella cattarhalis": "--", "Proteus spp.": "+", "E. coli": "+", "Klebsiella": "+", "Serratia": "X", "Enterobacter cloacae": "X", "Pseudomonas aeruginosa": "X", "Atypical respiratory pathogens": "X", "B. fragilis": "--", "Spectrum Score": "14.0", "Original Order": "", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "", "Varicella-zoster virus": "", "Cyto-megalovirus": "", "Respiratory syncytial virus": "", "Influenza A": "", "Influenza B": "", "SARS-CoV-2": ""}, {"Category": "Antibacterials", "Drug": "Cefuroxime", "Class": "Cephalosporin", "Route": "IV/PO", "Strep pyogenes": "+++", "S. pneumoniae": "++", "Staph aureus (MSSA)": "++", "Staph aureus (MRSA)": "X", "Enterooccus faecalis": "X", "Enterococcus faecium (VRE)": "X", "H. influenzae": "++", "Moraxella cattarhalis": "++", "Proteus spp.": "+++", "E. coli": "++", "Klebsiella": "++", "Serratia": "X", "Enterobacter cloacae": "X", "Pseudomonas aeruginosa": "X", "Atypical respiratory pathogens": "X", "B. fragilis": "X", "Spectrum Score": "20.0", "Original Order": "", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "", "Varicella-zoster virus": "", "Cyto-megalovirus": "", "Respiratory syncytial virus": "", "Influenza A": "", "Influenza B": "", "SARS-CoV-2": ""}, {"Category": "Antibacterials", "Drug": "Cefotetan/Cefoxitin", "Class": "Cephalosporin", "Route": "IV", "Strep pyogenes": "+++", "S. pneumoniae": "++", "Staph aureus (MSSA)": "++", "Staph aureus (MRSA)": "X", "Enterooccus faecalis": "X", "Enterococcus faecium (VRE)": "X", "H. influenzae": "++", "Moraxella cattarhalis": "++", "Proteus spp.": "+++", "E. coli": "++", "Klebsiella": "++", "Serratia": "X", "Enterobacter cloacae": "X", "Pseudomonas aeruginosa": "X", "Atypical respiratory pathogens": "X", "B. fragilis": "++", "Spectrum Score": "21.0", "Original Order": "", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "", "Varicella-zoster virus": "", "Cyto-megalovirus": "", "Respiratory syncytial virus": "", "Influenza A": "", "Influenza B": "", "SARS-CoV-2": ""}, {"Category": "Antibacterials", "Drug": "Ceftriaxone/Cefotaxime", "Class": "Cephalosporin", "Route": "IV", "Strep pyogenes": "+++", "S. pneumoniae": "+++", "Staph aureus (MSSA)": "++", "Staph aureus (MRSA)": "X", "Enterooccus faecalis": "X", "Enterococcus faecium (VRE)": "X", "H. influenzae": "+++", "Moraxella cattarhalis": "+++", "Proteus spp.": "+++", "E. coli": "+++", "Klebsiella": "+++", "Serratia": "+++", "Enterobacter cloacae": "++", "Pseudomonas aeruginosa": "--", "Atypical respiratory pathogens": "X", "B. fragilis": "--", "Spectrum Score": "31.0", "Original Order": "", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "", "Varicella-zoster virus": "", "Cyto-megalovirus": "", "Respiratory syncytial virus": "", "Influenza A": "", "Influenza B": "", "SARS-CoV-2": ""}, {"Category": "Antibacterials", "Drug": "Ceftazidime", "Class": "Cephalosporin", "Route": "IV", "Strep pyogenes": "+++", "S. pneumoniae": "+", "Staph aureus (MSSA)": "--", "Staph aureus (MRSA)": "X", "Enterooccus faecalis": "X", "Enterococcus faecium (VRE)": "X", "H. influenzae": "+++", "Moraxella cattarhalis": "+++", "Proteus spp.": "+++", "E. coli": "+++", "Klebsiella": "+++", "Serratia": "+++", "Enterobacter cloacae": "++", "Pseudomonas aeruginosa": "++", "Atypical respiratory pathogens": "X", "B. fragilis": "--", "Spectrum Score": "28.0", "Original Order": "", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "", "Varicella-zoster virus": "", "Cyto-megalovirus": "", "Respiratory syncytial virus": "", "Influenza A": "", "Influenza B": "", "SARS-CoV-2": ""}, {"Category": "Antibacterials", "Drug": "Ceftazidime/avibactam", "Class": "Cephalosporin", "Route": "IV", "Strep pyogenes": "+++", "S. pneumoniae": "--", "Staph aureus (MSSA)": "--", "Staph aureus (MRSA)": "X", "Enterooccus faecalis": "X", "Enterococcus faecium (VRE)": "X", "H. influenzae": "+++", "Moraxella cattarhalis": "+++", "Proteus spp.": "+++", "E. coli": "+++", "Klebsiella": "+++", "Serratia": "+++", "Enterobacter cloacae": "+++", "Pseudomonas aeruginosa": "+++", "Atypical respiratory pathogens": "X", "B. fragilis": "--", "Spectrum Score": "30.0", "Original Order": "", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "", "Varicella-zoster virus": "", "Cyto-megalovirus": "", "Respiratory syncytial virus": "", "Influenza A": "", "Influenza B": "", "SARS-CoV-2": ""}, {"Category": "Antibacterials", "Drug": "Ceftolozane/tazobactam", "Class": "Cephalosporin", "Route": "IV", "Strep pyogenes": "+++", "S. pneumoniae": "--", "Staph aureus (MSSA)": "--", "Staph aureus (MRSA)": "X", "Enterooccus faecalis": "X", "Enterococcus faecium (VRE)": "X", "H. influenzae": "+++", "Moraxella cattarhalis": "+++", "Proteus spp.": "+++", "E. coli": "+++", "Klebsiella": "+++", "Serratia": "+++", "Enterobacter cloacae": "++", "Pseudomonas aeruginosa": "+++", "Atypical respiratory pathogens": "X", "B. fragilis": "--", "Spectrum Score": "29.0", "Original Order": "", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "", "Varicella-zoster virus": "", "Cyto-megalovirus": "", "Respiratory syncytial virus": "", "Influenza A": "", "Influenza B": "", "SARS-CoV-2": ""}, {"Category": "Antibacterials", "Drug": "Cefepime", "Class": "Cephalosporin", "Route": "IV", "Strep pyogenes": "+++", "S. pneumoniae": "+++", "Staph aureus (MSSA)": "+++", "Staph aureus (MRSA)": "X", "Enterooccus faecalis": "X", "Enterococcus faecium (VRE)": "X", "H. influenzae": "+++", "Moraxella cattarhalis": "+++", "Proteus spp.": "+++", "E. coli": "+++", "Klebsiella": "+++", "Serratia": "+++", "Enterobacter cloacae": "++", "Pseudomonas aeruginosa": "++", "Atypical respiratory pathogens": "X", "B. fragilis": "--", "Spectrum Score": "35.0", "Original Order": "", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "", "Varicella-zoster virus": "", "Cyto-megalovirus": "", "Respiratory syncytial virus": "", "Influenza A": "", "Influenza B": "", "SARS-CoV-2": ""}, {"Category": "Antibacterials", "Drug": "Ceftaroline", "Class": "Cephalosporin", "Route": "IV", "Strep pyogenes": "+++", "S. pneumoniae": "+++", "Staph aureus (MSSA)": "+++", "Staph aureus (MRSA)": "++", "Enterooccus faecalis": "--", "Enterococcus faecium (VRE)": "--", "H. influenzae": "+++", "Moraxella cattarhalis": "+++", "Proteus spp.": "+++", "E. coli": "+++", "Klebsiella": "+++", "Serratia": "+++", "Enterobacter cloacae": "++", "Pseudomonas aeruginosa": "--", "Atypical respiratory pathogens": "X", "B. fragilis": "--", "Spectrum Score": "34.0", "Original Order": "", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "", "Varicella-zoster virus": "", "Cyto-megalovirus": "", "Respiratory syncytial virus": "", "Influenza A": "", "Influenza B": "", "SARS-CoV-2": ""}, {"Category": "Antibacterials", "Drug": "Aztreonam", "Class": "Monobactam", "Route": "IV", "Strep pyogenes": "X", "S. pneumoniae": "X", "Staph aureus (MSSA)": "X", "Staph aureus (MRSA)": "X", "Enterooccus faecalis": "X", "Enterococcus faecium (VRE)": "X", "H. influenzae": "+++", "Moraxella cattarhalis": "+++", "Proteus spp.": "+++", "E. coli": "+++", "Klebsiella": "+++", "Serratia": "+++", "Enterobacter cloacae": "++", "Pseudomonas aeruginosa": "++", "Atypical respiratory pathogens": "X", "B. fragilis": "X", "Spectrum Score": "25.0", "Original Order": "", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "", "Varicella-zoster virus": "", "Cyto-megalovirus": "", "Respiratory syncytial virus": "", "Influenza A": "", "Influenza B": "", "SARS-CoV-2": ""}, {"Category": "Antibacterials", "Drug": "Ertapenem", "Class": "Carbapenem", "Route": "IV", "Strep pyogenes": "+++", "S. pneumoniae": "++", "Staph aureus (MSSA)": "+++", "Staph aureus (MRSA)": "X", "Enterooccus faecalis": "X", "Enterococcus faecium (VRE)": "X", "H. influenzae": "+++", "Moraxella cattarhalis": "+++", "Proteus spp.": "+++", "E. coli": "+++", "Klebsiella": "+++", "Serratia": "+++", "Enterobacter cloacae": "+++", "Pseudomonas aeruginosa": "X", "Atypical respiratory pathogens": "X", "B. fragilis": "+++", "Spectrum Score": "38.0", "Original Order": "", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "", "Varicella-zoster virus": "", "Cyto-megalovirus": "", "Respiratory syncytial virus": "", "Influenza A": "", "Influenza B": "", "SARS-CoV-2": ""}, {"Category": "Antibacterials", "Drug": "Imi/Meropenem", "Class": "Carbapenem", "Route": "IV", "Strep pyogenes": "+++", "S. pneumoniae": "++", "Staph aureus (MSSA)": "+++", "Staph aureus (MRSA)": "X", "Enterooccus faecalis": "+", "Enterococcus faecium (VRE)": "--", "H. influenzae": "+++", "Moraxella cattarhalis": "+++", "Proteus spp.": "+++", "E. coli": "+++", "Klebsiella": "+++", "Serratia": "+++", "Enterobacter cloacae": "+++", "Pseudomonas aeruginosa": "++", "Atypical respiratory pathogens": "X", "B. fragilis": "+++", "Spectrum Score": "41.0", "Original Order": "", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "", "Varicella-zoster virus": "", "Cyto-megalovirus": "", "Respiratory syncytial virus": "", "Influenza A": "", "Influenza B": "", "SARS-CoV-2": ""}, {"Category": "Antibacterials", "Drug": "Ciprofloxacin", "Class": "Fluoroquinolone", "Route": "IV/PO", "Strep pyogenes": "++", "S. pneumoniae": "--", "Staph aureus (MSSA)": "--", "Staph aureus (MRSA)": "--", "Enterooccus faecalis": "--", "Enterococcus faecium (VRE)": "--", "H. influenzae": "+++", "Moraxella cattarhalis": "+++", "Proteus spp.": "+++", "E. coli": "++", "Klebsiella": "+++", "Serratia": "+++", "Enterobacter cloacae": "++", "Pseudomonas aeruginosa": "++", "Atypical respiratory pathogens": "--", "B. fragilis": "--", "Spectrum Score": "27.0", "Original Order": "", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "", "Varicella-zoster virus": "", "Cyto-megalovirus": "", "Respiratory syncytial virus": "", "Influenza A": "", "Influenza B": "", "SARS-CoV-2": ""}, {"Category": "Antibacterials", "Drug": "Levofloxacin", "Class": "Fluoroquinolone", "Route": "IV/PO", "Strep pyogenes": "+++", "S. pneumoniae": "+++", "Staph aureus (MSSA)": "--", "Staph aureus (MRSA)": "--", "Enterooccus faecalis": "--", "Enterococcus faecium (VRE)": "--", "H. influenzae": "+++", "Moraxella cattarhalis": "+++", "Proteus spp.": "+++", "E. coli": "++", "Klebsiella": "+++", "Serratia": "+++", "Enterobacter cloacae": "++", "Pseudomonas aeruginosa": "++", "Atypical respiratory pathogens": "+++", "B. fragilis": "--", "Spectrum Score": "35.0", "Original Order": "", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "", "Varicella-zoster virus": "", "Cyto-megalovirus": "", "Respiratory syncytial virus": "", "Influenza A": "", "Influenza B": "", "SARS-CoV-2": ""}, {"Category": "Antibacterials", "Drug": "Moxifloxacin", "Class": "Fluoroquinolone", "Route": "IV/PO", "Strep pyogenes": "+++", "S. pneumoniae": "+++", "Staph aureus (MSSA)": "--", "Staph aureus (MRSA)": "--", "Enterooccus faecalis": "--", "Enterococcus faecium (VRE)": "--", "H. influenzae": "+++", "Moraxella cattarhalis": "+++", "Proteus spp.": "+++", "E. coli": "++", "Klebsiella": "+++", "Serratia": "+++", "Enterobacter cloacae": "++", "Pseudomonas aeruginosa": "--", "Atypical respiratory pathogens": "+++", "B. fragilis": "+", "Spectrum Score": "35.0", "Original Order": "", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "", "Varicella-zoster virus": "", "Cyto-megalovirus": "", "Respiratory syncytial virus": "", "Influenza A": "", "Influenza B": "", "SARS-CoV-2": ""}, {"Category": "Antibacterials", "Drug": "Erythromycin", "Class": "Macrolide", "Route": "IV/PO", "Strep pyogenes": "++", "S. pneumoniae": "+", "Staph aureus (MSSA)": "--", "Staph aureus (MRSA)": "--", "Enterooccus faecalis": "X", "Enterococcus faecium (VRE)": "X", "H. influenzae": "--", "Moraxella cattarhalis": "--", "Proteus spp.": "--", "E. coli": "--", "Klebsiella": "--", "Serratia": "X", "Enterobacter cloacae": "X", "Pseudomonas aeruginosa": "X", "Atypical respiratory pathogens": "++", "B. fragilis": "X", "Spectrum Score": "7.0", "Original Order": "", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "", "Varicella-zoster virus": "", "Cyto-megalovirus": "", "Respiratory syncytial virus": "", "Influenza A": "", "Influenza B": "", "SARS-CoV-2": ""}, {"Category": "Antibacterials", "Drug": "Clarithromycin", "Class": "Macrolide", "Route": "PO", "Strep pyogenes": "++", "S. pneumoniae": "+", "Staph aureus (MSSA)": "--", "Staph aureus (MRSA)": "--", "Enterooccus faecalis": "X", "Enterococcus faecium (VRE)": "X", "H. influenzae": "+", "Moraxella cattarhalis": "+", "Proteus spp.": "--", "E. coli": "--", "Klebsiella": "--", "Serratia": "X", "Enterobacter cloacae": "X", "Pseudomonas aeruginosa": "X", "Atypical respiratory pathogens": "+++", "B. fragilis": "X", "Spectrum Score": "10.0", "Original Order": "", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "", "Varicella-zoster virus": "", "Cyto-megalovirus": "", "Respiratory syncytial virus": "", "Influenza A": "", "Influenza B": "", "SARS-CoV-2": ""}, {"Category": "Antibacterials", "Drug": "Azithromycin", "Class": "Macrolide", "Route": "IV/PO", "Strep pyogenes": "++", "S. pneumoniae": "+", "Staph aureus (MSSA)": "--", "Staph aureus (MRSA)": "--", "Enterooccus faecalis": "X", "Enterococcus faecium (VRE)": "X", "H. influenzae": "++", "Moraxella cattarhalis": "++", "Proteus spp.": "--", "E. coli": "--", "Klebsiella": "--", "Serratia": "X", "Enterobacter cloacae": "X", "Pseudomonas aeruginosa": "X", "Atypical respiratory pathogens": "+++", "B. fragilis": "X", "Spectrum Score": "12.0", "Original Order": "", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "", "Varicella-zoster virus": "", "Cyto-megalovirus": "", "Respiratory syncytial virus": "", "Influenza A": "", "Influenza B": "", "SARS-CoV-2": ""}, {"Category": "Antibacterials", "Drug": "Doxycycline", "Class": "Tetracycline", "Route": "IV/PO", "Strep pyogenes": "++", "S. pneumoniae": "++", "Staph aureus (MSSA)": "++", "Staph aureus (MRSA)": "++", "Enterooccus faecalis": "--", "Enterococcus faecium (VRE)": "--", "H. influenzae": "++", "Moraxella cattarhalis": "++", "Proteus spp.": "--", "E. coli": "--", "Klebsiella": "--", "Serratia": "--", "Enterobacter cloacae": "--", "Pseudomonas aeruginosa": "X", "Atypical respiratory pathogens": "+++", "B. fragilis": "--", "Spectrum Score": "16.0", "Original Order": "", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "", "Varicella-zoster virus": "", "Cyto-megalovirus": "", "Respiratory syncytial virus": "", "Influenza A": "", "Influenza B": "", "SARS-CoV-2": ""}, {"Category": "Antibacterials", "Drug": "Tigecycline", "Class": "Tetracycline", "Route": "IV", "Strep pyogenes": "+++", "S. pneumoniae": "+++", "Staph aureus (MSSA)": "+++", "Staph aureus (MRSA)": "+++", "Enterooccus faecalis": "++", "Enterococcus faecium (VRE)": "++", "H. influenzae": "+++", "Moraxella cattarhalis": "+++", "Proteus spp.": "--", "E. coli": "+++", "Klebsiella": "+++", "Serratia": "+++", "Enterobacter cloacae": "+++", "Pseudomonas aeruginosa": "X", "Atypical respiratory pathogens": "+++", "B. fragilis": "+++", "Spectrum Score": "42.0", "Original Order": "", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "", "Varicella-zoster virus": "", "Cyto-megalovirus": "", "Respiratory syncytial virus": "", "Influenza A": "", "Influenza B": "", "SARS-CoV-2": ""}, {"Category": "Antibacterials", "Drug": "Gentamicin/tobramycin", "Class": "Aminoglycoside", "Route": "IV", "Strep pyogenes": "syn", "S. pneumoniae": "syn", "Staph aureus (MSSA)": "syn", "Staph aureus (MRSA)": "syn", "Enterooccus faecalis": "syn", "Enterococcus faecium (VRE)": "syn", "H. influenzae": "--", "Moraxella cattarhalis": "--", "Proteus spp.": "+++", "E. coli": "+++", "Klebsiella": "+++", "Serratia": "+++", "Enterobacter cloacae": "+++", "Pseudomonas aeruginosa": "++", "Atypical respiratory pathogens": "--", "B. fragilis": "--", "Spectrum Score": "18.0", "Original Order": "", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "", "Varicella-zoster virus": "", "Cyto-megalovirus": "", "Respiratory syncytial virus": "", "Influenza A": "", "Influenza B": "", "SARS-CoV-2": ""}, {"Category": "Antibacterials", "Drug": "TMP/SMX", "Class": "Antifolate", "Route": "IV/PO", "Strep pyogenes": "++", "S. pneumoniae": "+", "Staph aureus (MSSA)": "+++", "Staph aureus (MRSA)": "++", "Enterooccus faecalis": "X", "Enterococcus faecium (VRE)": "X", "H. influenzae": "--", "Moraxella cattarhalis": "--", "Proteus spp.": "++", "E. coli": "+", "Klebsiella": "++", "Serratia": "++", "Enterobacter cloacae": "++", "Pseudomonas aeruginosa": "X", "Atypical respiratory pathogens": "--", "B. fragilis": "--", "Spectrum Score": "13.0", "Original Order": "", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "", "Varicella-zoster virus": "", "Cyto-megalovirus": "", "Respiratory syncytial virus": "", "Influenza A": "", "Influenza B": "", "SARS-CoV-2": ""}, {"Category": "Antibacterials", "Drug": "Clindamycin", "Class": "Lincosamide", "Route": "IV/PO", "Strep pyogenes": "++", "S. pneumoniae": "++", "Staph aureus (MSSA)": "++", "Staph aureus (MRSA)": "+", "Enterooccus faecalis": "X", "Enterococcus faecium (VRE)": "X", "H. influenzae": "X", "Moraxella cattarhalis": "X", "Proteus spp.": "X", "E. coli": "X", "Klebsiella": "X", "Serratia": "X", "Enterobacter cloacae": "X", "Pseudomonas aeruginosa": "X", "Atypical respiratory pathogens": "--", "B. fragilis": "+", "Spectrum Score": "8.0", "Original Order": "", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "", "Varicella-zoster virus": "", "Cyto-megalovirus": "", "Respiratory syncytial virus": "", "Influenza A": "", "Influenza B": "", "SARS-CoV-2": ""}, {"Category": "Antibacterials", "Drug": "Metronidazole", "Class": "Nitroimidazole", "Route": "IV/PO", "Strep pyogenes": "X", "S. pneumoniae": "X", "Staph aureus (MSSA)": "X", "Staph aureus (MRSA)": "X", "Enterooccus faecalis": "X", "Enterococcus faecium (VRE)": "X", "H. influenzae": "X", "Moraxella cattarhalis": "X", "Proteus spp.": "X", "E. coli": "X", "Klebsiella": "X", "Serratia": "X", "Enterobacter cloacae": "X", "Pseudomonas aeruginosa": "X", "Atypical respiratory pathogens": "X", "B. fragilis": "+++", "Spectrum Score": "3.0", "Original Order": "", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "", "Varicella-zoster virus": "", "Cyto-megalovirus": "", "Respiratory syncytial virus": "", "Influenza A": "", "Influenza B": "", "SARS-CoV-2": ""}, {"Category": "Antibacterials", "Drug": "Linezolid", "Class": "Oxazolidininone", "Route": "IV/PO", "Strep pyogenes": "+++", "S. pneumoniae": "+++", "Staph aureus (MSSA)": "+++", "Staph aureus (MRSA)": "+++", "Enterooccus faecalis": "+++", "Enterococcus faecium (VRE)": "+++", "H. influenzae": "--", "Moraxella cattarhalis": "--", "Proteus spp.": "X", "E. coli": "X", "Klebsiella": "X", "Serratia": "X", "Enterobacter cloacae": "X", "Pseudomonas aeruginosa": "X", "Atypical respiratory pathogens": "--", "B. fragilis": "--", "Spectrum Score": "18.0", "Original Order": "", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "", "Varicella-zoster virus": "", "Cyto-megalovirus": "", "Respiratory syncytial virus": "", "Influenza A": "", "Influenza B": "", "SARS-CoV-2": ""}, {"Category": "Antibacterials", "Drug": "Daptomycin", "Class": "Lipopeptide", "Route": "IV", "Strep pyogenes": "+++", "S. pneumoniae": "+++", "Staph aureus (MSSA)": "+++", "Staph aureus (MRSA)": "+++", "Enterooccus faecalis": "+++", "Enterococcus faecium (VRE)": "++", "H. influenzae": "X", "Moraxella cattarhalis": "X", "Proteus spp.": "X", "E. coli": "X", "Klebsiella": "X", "Serratia": "X", "Enterobacter cloacae": "X", "Pseudomonas aeruginosa": "X", "Atypical respiratory pathogens": "X", "B. fragilis": "X", "Spectrum Score": "17.0", "Original Order": "", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "", "Varicella-zoster virus": "", "Cyto-megalovirus": "", "Respiratory syncytial virus": "", "Influenza A": "", "Influenza B": "", "SARS-CoV-2": ""}, {"Category": "Antibacterials", "Drug": "Vancomycin/Dalba/Orita", "Class": "Glycopeptide", "Route": "IV", "Strep pyogenes": "+++", "S. pneumoniae": "+++", "Staph aureus (MSSA)": "+++", "Staph aureus (MRSA)": "+++", "Enterooccus faecalis": "+++", "Enterococcus faecium (VRE)": "--", "H. influenzae": "X", "Moraxella cattarhalis": "X", "Proteus spp.": "X", "E. coli": "X", "Klebsiella": "X", "Serratia": "X", "Enterobacter cloacae": "X", "Pseudomonas aeruginosa": "X", "Atypical respiratory pathogens": "X", "B. fragilis": "X", "Spectrum Score": "15.0", "Original Order": "", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "", "Varicella-zoster virus": "", "Cyto-megalovirus": "", "Respiratory syncytial virus": "", "Influenza A": "", "Influenza B": "", "SARS-CoV-2": ""}, {"Category": "Antifungals", "Drug": "Amphotericin B", "Class": "Polyene", "Route": "IV", "Strep pyogenes": "", "S. pneumoniae": "", "Staph aureus (MSSA)": "", "Staph aureus (MRSA)": "", "Enterooccus faecalis": "", "Enterococcus faecium (VRE)": "", "H. influenzae": "", "Moraxella cattarhalis": "", "Proteus spp.": "", "E. coli": "", "Klebsiella": "", "Serratia": "", "Enterobacter cloacae": "", "Pseudomonas aeruginosa": "", "Atypical respiratory pathogens": "", "B. fragilis": "", "Spectrum Score": "", "Original Order": "1.0", "Candida albicans/ parapsilosis/ tropicalis": "+++", "Candida glabrata": "+++", "Candida krusei": "+++", "Cryptococcus neoformans": "+++", "Coccidioides immitis": "+++", "Aspergillus spp": "++", "Fusarium spp": "+", "Zygomyces": "++", "Herpes simplex virus": "", "Varicella-zoster virus": "", "Cyto-megalovirus": "", "Respiratory syncytial virus": "", "Influenza A": "", "Influenza B": "", "SARS-CoV-2": ""}, {"Category": "Antifungals", "Drug": "Fluconazole", "Class": "Azole", "Route": "IV/PO", "Strep pyogenes": "", "S. pneumoniae": "", "Staph aureus (MSSA)": "", "Staph aureus (MRSA)": "", "Enterooccus faecalis": "", "Enterococcus faecium (VRE)": "", "H. influenzae": "", "Moraxella cattarhalis": "", "Proteus spp.": "", "E. coli": "", "Klebsiella": "", "Serratia": "", "Enterobacter cloacae": "", "Pseudomonas aeruginosa": "", "Atypical respiratory pathogens": "", "B. fragilis": "", "Spectrum Score": "", "Original Order": "2.0", "Candida albicans/ parapsilosis/ tropicalis": "+++", "Candida glabrata": "+", "Candida krusei": "X", "Cryptococcus neoformans": "+++", "Coccidioides immitis": "+++", "Aspergillus spp": "X", "Fusarium spp": "X", "Zygomyces": "X", "Herpes simplex virus": "", "Varicella-zoster virus": "", "Cyto-megalovirus": "", "Respiratory syncytial virus": "", "Influenza A": "", "Influenza B": "", "SARS-CoV-2": ""}, {"Category": "Antifungals", "Drug": "Itraconazole", "Class": "Azole", "Route": "PO", "Strep pyogenes": "", "S. pneumoniae": "", "Staph aureus (MSSA)": "", "Staph aureus (MRSA)": "", "Enterooccus faecalis": "", "Enterococcus faecium (VRE)": "", "H. influenzae": "", "Moraxella cattarhalis": "", "Proteus spp.": "", "E. coli": "", "Klebsiella": "", "Serratia": "", "Enterobacter cloacae": "", "Pseudomonas aeruginosa": "", "Atypical respiratory pathogens": "", "B. fragilis": "", "Spectrum Score": "", "Original Order": "3.0", "Candida albicans/ parapsilosis/ tropicalis": "+++", "Candida glabrata": "+", "Candida krusei": "+", "Cryptococcus neoformans": "+++", "Coccidioides immitis": "+++", "Aspergillus spp": "+", "Fusarium spp": "--", "Zygomyces": "--", "Herpes simplex virus": "", "Varicella-zoster virus": "", "Cyto-megalovirus": "", "Respiratory syncytial virus": "", "Influenza A": "", "Influenza B": "", "SARS-CoV-2": ""}, {"Category": "Antifungals", "Drug": "Voriconazole", "Class": "Azole", "Route": "IV/PO", "Strep pyogenes": "", "S. pneumoniae": "", "Staph aureus (MSSA)": "", "Staph aureus (MRSA)": "", "Enterooccus faecalis": "", "Enterococcus faecium (VRE)": "", "H. influenzae": "", "Moraxella cattarhalis": "", "Proteus spp.": "", "E. coli": "", "Klebsiella": "", "Serratia": "", "Enterobacter cloacae": "", "Pseudomonas aeruginosa": "", "Atypical respiratory pathogens": "", "B. fragilis": "", "Spectrum Score": "", "Original Order": "4.0", "Candida albicans/ parapsilosis/ tropicalis": "+++", "Candida glabrata": "+", "Candida krusei": "+++", "Cryptococcus neoformans": "+++", "Coccidioides immitis": "+++", "Aspergillus spp": "+++", "Fusarium spp": "+++", "Zygomyces": "--", "Herpes simplex virus": "", "Varicella-zoster virus": "", "Cyto-megalovirus": "", "Respiratory syncytial virus": "", "Influenza A": "", "Influenza B": "", "SARS-CoV-2": ""}, {"Category": "Antifungals", "Drug": "Posa/Isavuconazole", "Class": "Azole", "Route": "IV/PO", "Strep pyogenes": "", "S. pneumoniae": "", "Staph aureus (MSSA)": "", "Staph aureus (MRSA)": "", "Enterooccus faecalis": "", "Enterococcus faecium (VRE)": "", "H. influenzae": "", "Moraxella cattarhalis": "", "Proteus spp.": "", "E. coli": "", "Klebsiella": "", "Serratia": "", "Enterobacter cloacae": "", "Pseudomonas aeruginosa": "", "Atypical respiratory pathogens": "", "B. fragilis": "", "Spectrum Score": "", "Original Order": "5.0", "Candida albicans/ parapsilosis/ tropicalis": "+++", "Candida glabrata": "+", "Candida krusei": "+++", "Cryptococcus neoformans": "+++", "Coccidioides immitis": "+++", "Aspergillus spp": "+++", "Fusarium spp": "+", "Zygomyces": "++", "Herpes simplex virus": "", "Varicella-zoster virus": "", "Cyto-megalovirus": "", "Respiratory syncytial virus": "", "Influenza A": "", "Influenza B": "", "SARS-CoV-2": ""}, {"Category": "Antifungals", "Drug": "Caspo/mica/ anidulafungin", "Class": "Echinocandin", "Route": "IV", "Strep pyogenes": "", "S. pneumoniae": "", "Staph aureus (MSSA)": "", "Staph aureus (MRSA)": "", "Enterooccus faecalis": "", "Enterococcus faecium (VRE)": "", "H. influenzae": "", "Moraxella cattarhalis": "", "Proteus spp.": "", "E. coli": "", "Klebsiella": "", "Serratia": "", "Enterobacter cloacae": "", "Pseudomonas aeruginosa": "", "Atypical respiratory pathogens": "", "B. fragilis": "", "Spectrum Score": "", "Original Order": "6.0", "Candida albicans/ parapsilosis/ tropicalis": "+++", "Candida glabrata": "+++", "Candida krusei": "+++", "Cryptococcus neoformans": "X", "Coccidioides immitis": "--", "Aspergillus spp": "++", "Fusarium spp": "--", "Zygomyces": "syn", "Herpes simplex virus": "", "Varicella-zoster virus": "", "Cyto-megalovirus": "", "Respiratory syncytial virus": "", "Influenza A": "", "Influenza B": "", "SARS-CoV-2": ""}, {"Category": "Antivirals", "Drug": "Acyclovir/Valacyclovir", "Class": "Nucleoside analog", "Route": "IV/PO", "Strep pyogenes": "", "S. pneumoniae": "", "Staph aureus (MSSA)": "", "Staph aureus (MRSA)": "", "Enterooccus faecalis": "", "Enterococcus faecium (VRE)": "", "H. influenzae": "", "Moraxella cattarhalis": "", "Proteus spp.": "", "E. coli": "", "Klebsiella": "", "Serratia": "", "Enterobacter cloacae": "", "Pseudomonas aeruginosa": "", "Atypical respiratory pathogens": "", "B. fragilis": "", "Spectrum Score": "", "Original Order": "1.0", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "+++", "Varicella-zoster virus": "++", "Cyto-megalovirus": "--", "Respiratory syncytial virus": "--", "Influenza A": "X", "Influenza B": "X", "SARS-CoV-2": "X"}, {"Category": "Antivirals", "Drug": "Famciclovir", "Class": "Nucleoside analog", "Route": "PO", "Strep pyogenes": "", "S. pneumoniae": "", "Staph aureus (MSSA)": "", "Staph aureus (MRSA)": "", "Enterooccus faecalis": "", "Enterococcus faecium (VRE)": "", "H. influenzae": "", "Moraxella cattarhalis": "", "Proteus spp.": "", "E. coli": "", "Klebsiella": "", "Serratia": "", "Enterobacter cloacae": "", "Pseudomonas aeruginosa": "", "Atypical respiratory pathogens": "", "B. fragilis": "", "Spectrum Score": "", "Original Order": "", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "+++", "Varicella-zoster virus": "++", "Cyto-megalovirus": "--", "Respiratory syncytial virus": "--", "Influenza A": "X", "Influenza B": "X", "SARS-CoV-2": "X"}, {"Category": "Antivirals", "Drug": "Ganciclovir/Valganciclovir", "Class": "Nucleoside analog", "Route": "IV/PO", "Strep pyogenes": "", "S. pneumoniae": "", "Staph aureus (MSSA)": "", "Staph aureus (MRSA)": "", "Enterooccus faecalis": "", "Enterococcus faecium (VRE)": "", "H. influenzae": "", "Moraxella cattarhalis": "", "Proteus spp.": "", "E. coli": "", "Klebsiella": "", "Serratia": "", "Enterobacter cloacae": "", "Pseudomonas aeruginosa": "", "Atypical respiratory pathogens": "", "B. fragilis": "", "Spectrum Score": "", "Original Order": "2.0", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "+++", "Varicella-zoster virus": "++", "Cyto-megalovirus": "++", "Respiratory syncytial virus": "--", "Influenza A": "X", "Influenza B": "X", "SARS-CoV-2": "X"}, {"Category": "Antivirals", "Drug": "Foscarnet", "Class": "Pyrophosphate analog", "Route": "IV", "Strep pyogenes": "", "S. pneumoniae": "", "Staph aureus (MSSA)": "", "Staph aureus (MRSA)": "", "Enterooccus faecalis": "", "Enterococcus faecium (VRE)": "", "H. influenzae": "", "Moraxella cattarhalis": "", "Proteus spp.": "", "E. coli": "", "Klebsiella": "", "Serratia": "", "Enterobacter cloacae": "", "Pseudomonas aeruginosa": "", "Atypical respiratory pathogens": "", "B. fragilis": "", "Spectrum Score": "", "Original Order": "3.0", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "+++", "Varicella-zoster virus": "++", "Cyto-megalovirus": "++", "Respiratory syncytial virus": "--", "Influenza A": "X", "Influenza B": "X", "SARS-CoV-2": "X"}, {"Category": "Antivirals", "Drug": "Cidofovir", "Class": "Nucleoside analog", "Route": "IV", "Strep pyogenes": "", "S. pneumoniae": "", "Staph aureus (MSSA)": "", "Staph aureus (MRSA)": "", "Enterooccus faecalis": "", "Enterococcus faecium (VRE)": "", "H. influenzae": "", "Moraxella cattarhalis": "", "Proteus spp.": "", "E. coli": "", "Klebsiella": "", "Serratia": "", "Enterobacter cloacae": "", "Pseudomonas aeruginosa": "", "Atypical respiratory pathogens": "", "B. fragilis": "", "Spectrum Score": "", "Original Order": "4.0", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "+++", "Varicella-zoster virus": "++", "Cyto-megalovirus": "++", "Respiratory syncytial virus": "--", "Influenza A": "X", "Influenza B": "X", "SARS-CoV-2": "X"}, {"Category": "Antivirals", "Drug": "Letermovir", "Class": "Terminase inhibitor", "Route": "PO", "Strep pyogenes": "", "S. pneumoniae": "", "Staph aureus (MSSA)": "", "Staph aureus (MRSA)": "", "Enterooccus faecalis": "", "Enterococcus faecium (VRE)": "", "H. influenzae": "", "Moraxella cattarhalis": "", "Proteus spp.": "", "E. coli": "", "Klebsiella": "", "Serratia": "", "Enterobacter cloacae": "", "Pseudomonas aeruginosa": "", "Atypical respiratory pathogens": "", "B. fragilis": "", "Spectrum Score": "", "Original Order": "", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "X", "Varicella-zoster virus": "X", "Cyto-megalovirus": "+++", "Respiratory syncytial virus": "X", "Influenza A": "X", "Influenza B": "X", "SARS-CoV-2": "X"}, {"Category": "Antivirals", "Drug": "Ribavirin", "Class": "Nucleoside analog", "Route": "INH/PO", "Strep pyogenes": "", "S. pneumoniae": "", "Staph aureus (MSSA)": "", "Staph aureus (MRSA)": "", "Enterooccus faecalis": "", "Enterococcus faecium (VRE)": "", "H. influenzae": "", "Moraxella cattarhalis": "", "Proteus spp.": "", "E. coli": "", "Klebsiella": "", "Serratia": "", "Enterobacter cloacae": "", "Pseudomonas aeruginosa": "", "Atypical respiratory pathogens": "", "B. fragilis": "", "Spectrum Score": "", "Original Order": "5.0", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "--", "Varicella-zoster virus": "--", "Cyto-megalovirus": "--", "Respiratory syncytial virus": "+++", "Influenza A": "--", "Influenza B": "--", "SARS-CoV-2": "X"}, {"Category": "Antivirals", "Drug": "Oseltamivir", "Class": "Neuraminidase inhibitor", "Route": "PO", "Strep pyogenes": "", "S. pneumoniae": "", "Staph aureus (MSSA)": "", "Staph aureus (MRSA)": "", "Enterooccus faecalis": "", "Enterococcus faecium (VRE)": "", "H. influenzae": "", "Moraxella cattarhalis": "", "Proteus spp.": "", "E. coli": "", "Klebsiella": "", "Serratia": "", "Enterobacter cloacae": "", "Pseudomonas aeruginosa": "", "Atypical respiratory pathogens": "", "B. fragilis": "", "Spectrum Score": "", "Original Order": "6.0", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "X", "Varicella-zoster virus": "X", "Cyto-megalovirus": "X", "Respiratory syncytial virus": "X", "Influenza A": "+++", "Influenza B": "+++", "SARS-CoV-2": "X"}, {"Category": "Antivirals", "Drug": "Zanamivir", "Class": "Neuraminidase inhibitor", "Route": "INH", "Strep pyogenes": "", "S. pneumoniae": "", "Staph aureus (MSSA)": "", "Staph aureus (MRSA)": "", "Enterooccus faecalis": "", "Enterococcus faecium (VRE)": "", "H. influenzae": "", "Moraxella cattarhalis": "", "Proteus spp.": "", "E. coli": "", "Klebsiella": "", "Serratia": "", "Enterobacter cloacae": "", "Pseudomonas aeruginosa": "", "Atypical respiratory pathogens": "", "B. fragilis": "", "Spectrum Score": "", "Original Order": "7.0", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "X", "Varicella-zoster virus": "X", "Cyto-megalovirus": "X", "Respiratory syncytial virus": "X", "Influenza A": "+++", "Influenza B": "+++", "SARS-CoV-2": "X"}, {"Category": "Antivirals", "Drug": "Baloxavir", "Class": "Endonuclease inhibitor", "Route": "PO", "Strep pyogenes": "", "S. pneumoniae": "", "Staph aureus (MSSA)": "", "Staph aureus (MRSA)": "", "Enterooccus faecalis": "", "Enterococcus faecium (VRE)": "", "H. influenzae": "", "Moraxella cattarhalis": "", "Proteus spp.": "", "E. coli": "", "Klebsiella": "", "Serratia": "", "Enterobacter cloacae": "", "Pseudomonas aeruginosa": "", "Atypical respiratory pathogens": "", "B. fragilis": "", "Spectrum Score": "", "Original Order": "8.0", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "X", "Varicella-zoster virus": "X", "Cyto-megalovirus": "X", "Respiratory syncytial virus": "X", "Influenza A": "+++", "Influenza B": "+++", "SARS-CoV-2": "X"}, {"Category": "Antivirals", "Drug": "Nirmatrelvir", "Class": "Protease inhibitor", "Route": "PO", "Strep pyogenes": "", "S. pneumoniae": "", "Staph aureus (MSSA)": "", "Staph aureus (MRSA)": "", "Enterooccus faecalis": "", "Enterococcus faecium (VRE)": "", "H. influenzae": "", "Moraxella cattarhalis": "", "Proteus spp.": "", "E. coli": "", "Klebsiella": "", "Serratia": "", "Enterobacter cloacae": "", "Pseudomonas aeruginosa": "", "Atypical respiratory pathogens": "", "B. fragilis": "", "Spectrum Score": "", "Original Order": "", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "X", "Varicella-zoster virus": "X", "Cyto-megalovirus": "X", "Respiratory syncytial virus": "X", "Influenza A": "X", "Influenza B": "X", "SARS-CoV-2": "+++"}, {"Category": "Antivirals", "Drug": "Molnupiravir", "Class": "Polymerase mutagen", "Route": "PO", "Strep pyogenes": "", "S. pneumoniae": "", "Staph aureus (MSSA)": "", "Staph aureus (MRSA)": "", "Enterooccus faecalis": "", "Enterococcus faecium (VRE)": "", "H. influenzae": "", "Moraxella cattarhalis": "", "Proteus spp.": "", "E. coli": "", "Klebsiella": "", "Serratia": "", "Enterobacter cloacae": "", "Pseudomonas aeruginosa": "", "Atypical respiratory pathogens": "", "B. fragilis": "", "Spectrum Score": "", "Original Order": "", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "X", "Varicella-zoster virus": "X", "Cyto-megalovirus": "X", "Respiratory syncytial virus": "X", "Influenza A": "+", "Influenza B": "+", "SARS-CoV-2": "+++"}, {"Category": "Antivirals", "Drug": "Remdesivir", "Class": "Nucleoside analog", "Route": "IV", "Strep pyogenes": "", "S. pneumoniae": "", "Staph aureus (MSSA)": "", "Staph aureus (MRSA)": "", "Enterooccus faecalis": "", "Enterococcus faecium (VRE)": "", "H. influenzae": "", "Moraxella cattarhalis": "", "Proteus spp.": "", "E. coli": "", "Klebsiella": "", "Serratia": "", "Enterobacter cloacae": "", "Pseudomonas aeruginosa": "", "Atypical respiratory pathogens": "", "B. fragilis": "", "Spectrum Score": "", "Original Order": "", "Candida albicans/ parapsilosis/ tropicalis": "", "Candida glabrata": "", "Candida krusei": "", "Cryptococcus neoformans": "", "Coccidioides immitis": "", "Aspergillus spp": "", "Fusarium spp": "", "Zygomyces": "", "Herpes simplex virus": "X", "Varicella-zoster virus": "X", "Cyto-megalovirus": "X", "Respiratory syncytial virus": "X", "Influenza A": "X", "Influenza B": "X", "SARS-CoV-2": "+++"}];

  // Normalize route labels (avoid inconsistent IV/PO labels)
  function normalizeRouteLabel(v){
    if (v == null) return v;
    const raw = String(v).trim();
    const compact = raw.replace(/\s+/g, "").toUpperCase();
    if (compact === "PO/IV") return "IV/PO";
    return raw;
  }
  DATA.forEach(r => { if (r && typeof r.Route !== "undefined") r.Route = normalizeRouteLabel(r.Route); });


  const CAT_ORG = {"Antibacterials": ["Strep pyogenes", "S. pneumoniae", "Staph aureus (MSSA)", "Staph aureus (MRSA)", "Enterooccus faecalis", "Enterococcus faecium (VRE)", "H. influenzae", "Moraxella cattarhalis", "Proteus spp.", "E. coli", "Klebsiella", "Serratia", "Enterobacter cloacae", "Pseudomonas aeruginosa", "Atypical respiratory pathogens", "B. fragilis"], "Antifungals": ["Candida albicans/ parapsilosis/ tropicalis", "Candida glabrata", "Candida krusei", "Cryptococcus neoformans", "Coccidioides immitis", "Aspergillus spp", "Fusarium spp", "Zygomyces"], "Antivirals": ["Herpes simplex virus", "Varicella-zoster virus", "Cyto-megalovirus", "Respiratory syncytial virus", "Influenza A", "Influenza B", "SARS-CoV-2"]};

  const BASE_COLS = ["Category","Drug","Class","Route"];
  const OPTIONAL_COLS = ["Spectrum Score"];

  // Theme (light by default; user can toggle)
  (function initTheme(){
    const saved = localStorage.getItem("coast_theme");
    const initial = saved ? saved : "light";
    document.documentElement.dataset.theme = initial;
    const btn = document.getElementById("themeBtn");
    function refresh(){
      const isDark = document.documentElement.dataset.theme === "dark";
      btn.textContent = isDark ? "Light mode" : "Dark mode";
    }
    btn.addEventListener("click", () => {
      const next = (document.documentElement.dataset.theme === "dark") ? "light" : "dark";
      document.documentElement.dataset.theme = next;
      localStorage.setItem("coast_theme", next);
      refresh();
      // Some browsers need a tick before measuring widths
      setTimeout(() => { applyStickyColumns(); makeColumnsResizable(); }, 0);
    });
    refresh();
  })();

  // Sticky left columns through Route (so Drug/Route stay visible during horizontal scroll)
  function applyStickyColumns(){
    const table = document.getElementById("resultsTable");
    if (!table) return;
    const stickyCount = BASE_COLS.length; // Category, Drug, Class, Route
    const ths = Array.from(table.querySelectorAll("thead th"));
    if (ths.length < stickyCount) return;

    // Clear previous sticky styles
    ths.forEach(th => { th.classList.remove("sticky-left"); th.style.left = ""; });
    Array.from(table.querySelectorAll("tbody td.sticky-left")).forEach(td => { td.classList.remove("sticky-left"); td.style.left = ""; });

    let left = 0;
    for (let i = 0; i < stickyCount; i++) {
      const th = ths[i];
      th.classList.add("sticky-left");
      th.style.left = left + "px";

      const tds = table.querySelectorAll("tbody tr td:nth-child(" + (i+1) + ")");
      tds.forEach(td => {
        td.classList.add("sticky-left");
        td.style.left = left + "px";
      });

      left += th.getBoundingClientRect().width;
    }
  }

  
// Persist column widths so resizing "sticks" across re-renders (and optional page reload).
const COL_WIDTHS_STORAGE_KEY = "coast_colWidths_v1";
let colWidths = {};
try { colWidths = JSON.parse(localStorage.getItem(COL_WIDTHS_STORAGE_KEY) || "{}") || {}; } catch(e){ colWidths = {}; }
function saveColWidths(){
  try { localStorage.setItem(COL_WIDTHS_STORAGE_KEY, JSON.stringify(colWidths)); } catch(e){}
}

// Scroll sync for top horizontal scrollbar
let __syncingScroll = false;

  // Keep the main results table in its own vertical scroll area so sticky headers can work.
  function sizeResultsWrap(){
    const wrap = document.getElementById("resultsWrap");
    if(!wrap) return;
    const rect = wrap.getBoundingClientRect();
    const bottomPad = 16;          // breathing room above viewport bottom
    const minHeight = 260;         // avoid tiny scroll panes
    const avail = window.innerHeight - rect.top - bottomPad;
    wrap.style.maxHeight = Math.max(minHeight, avail) + "px";
  }

  function setupTopScrollbarSync(){
  const wrap = document.getElementById("resultsWrap");
  const top = document.getElementById("topHScroll");
  if(!wrap || !top) return;

  wrap.addEventListener("scroll", () => {
    if(__syncingScroll) return;
    __syncingScroll = true;
    top.scrollLeft = wrap.scrollLeft;
    __syncingScroll = false;
  });

  top.addEventListener("scroll", () => {
    if(__syncingScroll) return;
    __syncingScroll = true;
    wrap.scrollLeft = top.scrollLeft;
    __syncingScroll = false;
  });
}

function updateTopScrollbar(){
  const top = document.getElementById("topHScroll");
  const inner = document.getElementById("topHScrollInner");
  const wrap = document.getElementById("resultsWrap");
  const table = document.getElementById("resultsTable");
  if(!top || !inner || !wrap || !table) return;
  inner.style.width = table.scrollWidth + "px";
  const overflow = table.scrollWidth > wrap.clientWidth + 2;
  top.style.display = overflow ? "block" : "none";
  if(overflow){ top.scrollLeft = wrap.scrollLeft; }
}

// Guard against sorting click after a drag-resize
let __isResizingColumn = false;

// Ensure a colgroup exists and apply any saved widths.
function ensureColgroup(cols){
  const table = document.getElementById("resultsTable");
  if(!table) return;
  let cg = document.getElementById("resultsColgroup");
  if(!cg){
    cg = document.createElement("colgroup");
    cg.id = "resultsColgroup";
    table.insertBefore(cg, table.firstChild);
  }
  while(cg.children.length < cols.length){ cg.appendChild(document.createElement("col")); }
  while(cg.children.length > cols.length){ cg.removeChild(cg.lastChild); }
  cols.forEach((c, i) => {
    const w = colWidths[c];
    cg.children[i].style.width = w ? (w + "px") : "";
  });
}
// Make table columns draggable to resize
  function makeColumnsResizable(){
    const table = document.getElementById("resultsTable");
    if (!table) return;
    const ths = Array.from(table.querySelectorAll("thead th"));
    if (!ths.length) return;

    // Remove existing resizers (table re-renders often)
    ths.forEach(th => {
      th.classList.add("resizable");
      const old = th.querySelector(".col-resizer");
      if (old) old.remove();
      th.style.position = "sticky"; // keep sticky header behavior
    });

    function setColWidth(colIndex, px){
      const w = Math.max(60, px); // minimum width
      const th = ths[colIndex];
      th.style.width = w + "px";
      // Apply to body cells for consistent sizing
      const tds = table.querySelectorAll("tbody tr td:nth-child(" + (colIndex+1) + ")");
      tds.forEach(td => { td.style.width = w + "px"; });
      // Recompute sticky offsets so frozen columns stay aligned
      applyStickyColumns();
    }

    ths.forEach((th, i) => {
      // Skip last column (no need for handle)
      if (i === ths.length - 1) return;

      const resizer = document.createElement("div");
      resizer.className = "col-resizer";
      let colName = "";
      resizer.title = "Drag to resize column";
      resizer.addEventListener("click", (e) => e.stopPropagation()); // don't trigger sort
      th.appendChild(resizer);

      let startX = 0;
      let startW = 0;
      let dragging = false;

      const onMove = (e) => {
        if (!dragging) return;
        const clientX = (e.touches && e.touches.length) ? e.touches[0].clientX : e.clientX;
        const dx = clientX - startX;
        setColWidth(i, startW + dx);
      };

      const onUp = () => {
        if (!dragging) return;
        dragging = false;
        document.removeEventListener("mousemove", onMove);
        document.removeEventListener("mouseup", onUp);
        document.removeEventListener("touchmove", onMove);
        document.removeEventListener("touchend", onUp);
      };

      const onDown = (e) => {
        e.preventDefault();
        e.stopPropagation();
        __isResizingColumn = true;
        dragging = true;
        const clientX = (e.touches && e.touches.length) ? e.touches[0].clientX : e.clientX;
        startX = clientX;
        startW = th.getBoundingClientRect().width;
        document.addEventListener("mousemove", onMove);
        document.addEventListener("mouseup", onUp);
        document.addEventListener("touchmove", onMove, {passive:false});
        document.addEventListener("touchend", onUp);
      };

      resizer.addEventListener("mousedown", onDown);
      resizer.addEventListener("touchstart", onDown, {passive:false});
      resizer.addEventListener("click", (e)=>e.stopPropagation());
    });
  }



  window.addEventListener("resize", () => {
    // re-measure offsets after resize
    clearTimeout(window.__coastStickyT);
    window.__coastStickyT = setTimeout(applyStickyColumns, 80);
  });

  function score(val) {
    const v = (val ?? "").toString().trim();
    if (v === "+++") return 3;
    if (v === "++") return 2;
    if (v === "+") return 1;
    if (v.toLowerCase() === "syn") return 2; // treat as "moderate-ish" for filtering
    return 0; // X, --, blank
  }

  function activityClass(val) {
    const v = (val ?? "").toString().trim();
    if (!v) return "aN";
    if (v === "+++") return "a3";
    if (v === "++") return "a2";
    if (v === "+") return "a1";
    if (v.toLowerCase() === "syn") return "a2";
    if (v === "--" || v === "X") return "a0";
    return "aN";
  }

  function getSelectedValues(sel) {
    return Array.from(sel.selectedOptions).map(o=>o.value);
  }

  function setSelectedValues(sel, values) {
    const set = new Set(values);
    Array.from(sel.options).forEach(o => o.selected = set.has(o.value));
  }

  function unionOrgs(categories) {
    const set = new Set();
    categories.forEach(c => (CAT_ORG[c] || []).forEach(o => set.add(o)));
    return Array.from(set).sort((a,b)=>a.localeCompare(b));
  }

  // DOM
  const categorySel = document.getElementById("category");
  const routeSel = document.getElementById("route");
  const orgSel = document.getElementById("organisms");
  const drugPick = document.getElementById("drugPick");
  const drugSearch = document.getElementById("drugSearch");
  const showOnlySelectedOrgs = document.getElementById("showOnlySelectedOrgs");
  const minActivity = document.getElementById("minActivity");
  const resetBtn = document.getElementById("resetBtn");
  const exportBtn = document.getElementById("exportBtn");
  const theadRow = document.getElementById("theadRow");
  const tbody = document.getElementById("tbody");
  const countEl = document.getElementById("count");
  const activeFiltersEl = document.getElementById("activeFilters");

  let sortKey = "Drug";
  let sortDir = "asc";

  function renderOrganismOptions() {
    const cats = getSelectedValues(categorySel);
    const relevant = unionOrgs(cats);
    const selectedNow = new Set(getSelectedValues(orgSel));
    orgSel.innerHTML = "";
    relevant.forEach(o => {
      const opt = document.createElement("option");
      opt.value = o;
      opt.textContent = o;
      opt.selected = selectedNow.has(o);
      orgSel.appendChild(opt);
    });
  }

  function getOrgMatchMode() {
    return document.getElementById("orgAll").checked ? "all" : "any";
  }

  function applyFilters() {
    const cats = new Set(getSelectedValues(categorySel));
    const routes = new Set(getSelectedValues(routeSel));
    const q = drugSearch.value.trim().toLowerCase();
    const pickedDrugs = new Set(getSelectedValues(drugPick));
    const selectedOrgs = getSelectedValues(orgSel);
    const orgMode = getOrgMatchMode();
    const minScore = parseInt(minActivity.value, 10);

    // filter rows
    let rows = DATA.filter(r => cats.has(r.Category) && routes.has(r.Route));

    if (q) {
      rows = rows.filter(r => (r.Drug || "").toLowerCase().includes(q));
    }

    if (pickedDrugs.size > 0) {
      rows = rows.filter(r => pickedDrugs.has(r.Drug));
    }

    if (selectedOrgs.length > 0) {
      rows = rows.filter(r => {
        const hits = selectedOrgs.map(o => score(r[o]));
        if (orgMode === "all") return hits.every(s => s >= minScore);
        return hits.some(s => s >= minScore);
      });
    }

    // sort
    rows.sort((a,b) => {
      const av = (a[sortKey] ?? "").toString();
      const bv = (b[sortKey] ?? "").toString();
      const cmp = av.localeCompare(bv, undefined, {numeric:true, sensitivity:"base"});
      return sortDir === "asc" ? cmp : -cmp;
    });

    const pickedList = Array.from(pickedDrugs);
    renderTable(rows, selectedOrgs, cats);
    renderActiveFilterPills(cats, routes, q, pickedList, selectedOrgs, orgMode, minScore, rows.length);
  }

  function displayLabelForMinScore(s) {
    if (s === 3) return "+++ only";
    if (s === 2) return ">= ++";
    return ">= +";
  }

  function renderActiveFilterPills(cats, routes, q, pickedDrugs, orgs, orgMode, minScore, n) {
    activeFiltersEl.innerHTML = "";
    function pill(text) {
      const d = document.createElement("span");
      d.className = "pill";
      d.textContent = text;
      activeFiltersEl.appendChild(d);
    }
    pill("Rows: " + n);
    pill("Category: " + Array.from(cats).join(", "));
    pill("Route: " + Array.from(routes).join(", "));
    if (q) pill('Drug contains: "' + q + '"');
    if (pickedDrugs && pickedDrugs.length) pill("Drug pick: " + pickedDrugs.join(", "));
    if (orgs.length) pill("Organisms: " + orgs.join(", ") + " (" + orgMode + ", " + displayLabelForMinScore(minScore) + ")");
    countEl.textContent = n + " drug rows shown";
  }

  function chosenOrganismColumns(selectedOrgs, cats) {
    const relevant = unionOrgs(Array.from(cats));
    if (showOnlySelectedOrgs.checked) {
      return selectedOrgs.length ? selectedOrgs : relevant;
    }
    return relevant;
  }

  function renderTable(rows, selectedOrgs, cats) {
    const orgCols = chosenOrganismColumns(selectedOrgs, cats);

    // header
    theadRow.innerHTML = "";
    const cols = BASE_COLS.concat(
      OPTIONAL_COLS.filter(c => rows.some(r => ((r[c] ?? "").toString().trim() !== ""))),
      orgCols
    );

    cols.forEach(c => {
      const th = document.createElement("th");
      th.textContent = c;
      th.title = "Click to sort";
      th.addEventListener("click", () => {
        if (sortKey === c) sortDir = (sortDir === "asc") ? "desc" : "asc";
        else { sortKey = c; sortDir = "asc"; }
        applyFilters();
      });
      theadRow.appendChild(th);
    });

    // body
    tbody.innerHTML = "";
    rows.forEach(r => {
      const tr = document.createElement("tr");
      cols.forEach(c => {
        const td = document.createElement("td");
        const v = (r[c] ?? "").toString().trim();

        if (orgCols.includes(c)) {
          td.className = "activity " + activityClass(v);
          td.textContent = v || "";
        } else {
          td.className = "meta";
          td.textContent = v;
        }
        tr.appendChild(td);
      });
      tbody.appendChild(tr);
    });
    // After rendering, keep the left columns visible during horizontal scroll
    setTimeout(() => { applyStickyColumns(); makeColumnsResizable(); }, 0);
  }

  function exportCSV() {
    const table = document.getElementById("resultsTable");
    const rows = Array.from(table.querySelectorAll("tr"));
    const csv = rows.map(row => {
      const cells = Array.from(row.children).map(cell => {
        const text = (cell.textContent || "").replace(/\s+/g, " ").trim();
        if (/[",\n]/.test(text)) return '"' + text.replace(/"/g,'""') + '"';
        return text;
      });
      return cells.join(",");
    }).join("\n");

    const blob = new Blob([csv], {type: "text/csv;charset=utf-8;"});
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = "CoAST_filtered.csv";
    document.body.appendChild(a);
    a.click();
    a.remove();
    URL.revokeObjectURL(url);
  }

  function resetAll() {
    setSelectedValues(categorySel, Array.from(categorySel.options).map(o=>o.value));
    setSelectedValues(routeSel, Array.from(routeSel.options).map(o=>o.value));
    drugSearch.value = "";
    setSelectedValues(drugPick, []);
    document.getElementById("orgAny").checked = true;
    minActivity.value = "1";
    showOnlySelectedOrgs.checked = true;
    renderOrganismOptions();
    setSelectedValues(orgSel, []);
    applyFilters();
  }

  categorySel.addEventListener("change", () => { renderOrganismOptions(); applyFilters(); });
  routeSel.addEventListener("change", applyFilters);
  orgSel.addEventListener("change", applyFilters);
  showOnlySelectedOrgs.addEventListener("change", applyFilters);
  drugSearch.addEventListener("input", applyFilters);
  drugPick.addEventListener("change", applyFilters);
  document.addEventListener("keydown", (e) => {
    if (e.key === "/" && document.activeElement !== drugSearch) {
      e.preventDefault();
      drugSearch.focus();
    }
    if (e.key === "Escape") {
      if (document.activeElement === drugSearch) drugSearch.blur();
      if (drugSearch.value) {
        drugSearch.value = "";
    setSelectedValues(drugPick, []);
        applyFilters();
      }
    }
  });

  document.getElementById("orgAny").addEventListener("change", applyFilters);
  document.getElementById("orgAll").addEventListener("change", applyFilters);
  minActivity.addEventListener("change", applyFilters);

  resetBtn.addEventListener("click", resetAll);
  exportBtn.addEventListener("click", exportCSV);

  // init
  setupTopScrollbarSync();
  sizeResultsWrap();
  window.addEventListener("resize", () => { sizeResultsWrap(); updateTopScrollbar(); });
  renderOrganismOptions();
  applyFilters();
  setTimeout(() => { sizeResultsWrap(); updateTopScrollbar(); }, 0);
</script>
</body>
</html>
